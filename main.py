import streamlit as st

# -------------------------------
# 기본 설정
# -------------------------------
st.set_page_config(
    page_title="통계 × 엑셀 함수 실습 안내",
    page_icon="📊",
    layout="wide",
)

st.title("📊 통계 × 엑셀 함수 실습 안내")
st.caption("중학교 3학년 · 통계 배우고 엑셀로 직접 계산해 보는 수업")

# -------------------------------
# 사이드바 – 전체 수업 흐름
# -------------------------------
with st.sidebar:
    st.header("🧭 수업 흐름")
    st.markdown(
        r"""
1. **통계 개념 복습**  
   - 평균, 분산, 표준편차 개념 정리  

2. **엑셀 실습 파일 열기**  
   - 선생님이 배포한 `통계데이터실습.xlsx` 사용  

3. **엑셀 함수로 직접 계산**  
   - SUM, AVERAGE, VAR.P, STDEV.P 등  

4. **결과 해석 & 비교**  
   - 반의 성적 분포, 생활 데이터 패턴 해석하기  

💡 이 웹앱은 **설명·정리·퀴즈 전용**이고  
실제 계산과 그래프 그리기는 **엑셀에서** 합니다.
        """
    )

# -------------------------------
# 탭 구성
# -------------------------------
tab1, tab2, tab3, tab4 = st.tabs(
    [
        "1️⃣ 수업 목적 & 실습파일 구조",
        "2️⃣ 엑셀 함수 도구 설명 📘",
        "3️⃣ 실습 단계별 안내 ✅",
        "4️⃣ 개념 & 함수 퀴즈 🎯",
    ]
)

# -------------------------------
# 1️⃣ 수업 목적 & 실습파일 구조
# -------------------------------
with tab1:
    st.subheader("1️⃣ 수업 목적 & 실습 파일 구조 안내")

    st.markdown(
        r"""
### 🎯 수업의 큰 목표

1. **통계 개념 이해하기**
   - 평균(average)
   - 분산(variance)
   - 표준편차(standard deviation)

2. **엑셀로 통계값 계산하는 방법 익히기**
   - 기본 함수: `=SUM()`, `=AVERAGE()`, `=COUNT()`, `=SQRT()`
   - 분산/표준편차 함수: `=VAR.P()`, `=VAR.S()`, `=STDEV.P()`, `=STDEV.S()`

3. **실제 데이터(시험 점수, 생활 데이터 등)를 해석해 보기**
   - “우리 반 시험 결과는 어떤 특징이 있을까?”
   - “나의 공부/수면/운동 패턴은 어떨까?”

---

### 📂 엑셀 실습 파일 구조 예시

> 실제 시트 이름은 선생님이 만든 파일을 기준으로 설명합니다.

- **시트 ① `실습데이터1`**  
  간단한 숫자 데이터(점수, 키 등)가 들어 있음  
  → 목적: **SUM, AVERAGE, MIN, MAX, VAR.P, STDEV.P** 함수 연습

- **시트 ② `실습데이터2`**  
  `값`, `편차`, `편차²`, `분산`, `표준편차` 등을 **공식으로 직접 계산**해 보는 시트  
  → 목적: *공식으로 계산 → 엑셀 함수로 계산 → 두 결과 비교*

- **시트 ③ `수학 중간고사` / 시트 ④ `수학 기말고사`**  
  반 학생들의 시험 점수 데이터  
  → 목적: 반별 **평균·분산·표준편차**를 구하고  
    “어느 반이 점수가 더 고르게 나왔는지”,  
    “기말 성적이 얼마나 안정되었는지” 해석하기

---

### ✏️ 준비물 체크리스트

- 📁 선생님이 나눠준 **엑셀 실습 파일**  
- 💻 엑셀(또는 구글 스프레드시트)  
- 🧠 통계 개념(평균·분산·표준편차)에 대한 기본 지식
        """
    )

# -------------------------------
# 2️⃣ 엑셀 함수 도구 설명 📘
# -------------------------------
with tab2:
    st.subheader("2️⃣ <엑셀 함수 도구 설명>")

    st.markdown("#### 🔹 합계 / 평균 / 제곱 / 제곱근")

    st.code(
        r"""합계 구하기
=SUM(범위)

평균 구하기 (직접)
=(합계 셀)/COUNT(범위)

평균 구하기 (함수)
=AVERAGE(범위)

제곱 구하기
=(셀)^2

제곱근 구하기
=SQRT(셀)""",
        language="text",
    )

    st.markdown("---")
    st.markdown("#### 🔹 편차 / 분산")

    st.code(
        r"""편차
= (변량) - (평균)

분산 직접 구하기
= (편차 제곱 총합) / COUNT(범위)

모집단 분산 함수
=VAR.P(범위)

표본 분산 함수
=VAR.S(범위)""",
        language="text",
    )

    st.markdown(
        r"""
> 📎 **표본 자료란?**  
> 전체 자료의 수가 너무 많아서 전부 조사하기 어려울 때,  
> 그중 **일부만 뽑아서 조사한 자료**를 말합니다.  
> 뽑은 일부 자료로 전체(모집단)의 모습을 **추측**하거나  
> **대표값**으로 활용합니다.
        """
    )

    st.markdown("---")
    st.markdown("#### 🔹 표준편차")

    st.code(
        r"""표준편차 직접 구하기
=SQRT(분산)

모집단 표준편차 함수
=STDEV.P(범위)

표본 표준편차 함수
=STDEV.S(범위)""",
        language="text",
    )

    st.markdown("---")
    st.markdown("#### 🔹 용어 & 기호 정리")

    st.markdown(
        r"""
| 한국어      | 영어                 | 엑셀 함수 예시       | 비고                     |
|------------|----------------------|----------------------|--------------------------|
| 평균       | average              | `=AVERAGE(범위)`     |                          |
| 분산       | variation (variance) | `=VAR.P(범위)`       | 모집단 분산              |
| 표준편차   | standard deviation   | `=STDEV.P(범위)`     | 모집단 표준편차          |

- `P` 는 **모집단(Population)** 을 의미  
- `S` 는 **표본집단(Sample)** 을 의미  
        """
    )

# -------------------------------
# 3️⃣ 실습 단계별 안내 ✅
# -------------------------------
with tab3:
    st.subheader("3️⃣ 엑셀에서 따라 하는 실습 단계 안내 ✅")

    st.markdown(
        r"""
### 🔰 STEP 1. 실습 파일 열기

1. `통계데이터실습.xlsx` 파일을 연다.  
2. `실습데이터1` 시트로 이동한다.

---

### 🔰 STEP 2. 기본 통계 함수 연습 (실습데이터1)

1. 데이터가 들어 있는 범위를 확인한다. (예: `B2:B31`)  
2. **합계** 셀에 입력  
   ```excel
   =SUM(B2:B31)
